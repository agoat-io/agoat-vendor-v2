"use strict";(self.webpackChunkreactjs_public_viewer=self.webpackChunkreactjs_public_viewer||[]).push([[224,391,525],{45:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(587);function l(e,t){if(null==e)return{};var s,l,n=(0,a.A)(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(l=0;l<o.length;l++)s=o[l],-1===t.indexOf(s)&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}},224:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var a=s(318),l=s(330),n=s.n(l),o=s(813),i=s(977),r=s(893);const d=e=>{let{apiUrl:t="http://localhost:8080/api",showPublishedOnly:s=!0,page:l=1,limit:d=10,isAuthenticated:c=!1,maxContentLength:m=300,onPostClicked:p,onPostsLoaded:h,onError:x}=e;const[u,g]=(0,a.useState)([]),[v,b]=(0,a.useState)(!1),[w,f]=(0,a.useState)(null),[j,y]=(0,a.useState)(l),[N,P]=(0,a.useState)(1),[,L]=(0,a.useState)(0),S=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),_=e=>{let t=e;return!c&&t.length>m&&(t=t.substring(0,m)+"..."),i.A.sanitize(o.marked.parse(t))},k=(0,a.useCallback)(async()=>{console.log("PostsList: Fetching posts with params:",{apiUrl:t,page:j,limit:d,showPublishedOnly:s||!c}),b(!0),f(null);try{const l=new URLSearchParams({page:j.toString(),limit:d.toString()});!s&&c||l.append("published","true");const o="".concat(t,"/posts?").concat(l);console.log("PostsList: Making request to:",o);const i=await n().get(o);var e,a;if(i.data&&i.data.data)g(i.data.data),L((null===(e=i.data.meta)||void 0===e?void 0:e.total)||i.data.data.length),P((null===(a=i.data.meta)||void 0===a?void 0:a.total_pages)||Math.ceil(i.data.data.length/d)),console.log("PostsList: Loaded posts:",i.data.data.length),null===h||void 0===h||h(i.data.data);else g([])}catch(i){var l,o;const e=(null===(l=i.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.message)||i.message||"Failed to load posts";f(e),null===x||void 0===x||x(e)}finally{b(!1)}},[t,j,d,s,c,h,x]),C=e=>{e>=1&&e<=N&&y(e)},A=e=>{const t="".concat(e.slug,"/").concat(e.id),s=new URL(window.location.href);s.searchParams.set("post-path",t),window.history.pushState({},"",s.toString()),null===p||void 0===p||p(e)};return(0,a.useEffect)(()=>{k()},[k]),(0,a.useEffect)(()=>{y(l)},[l]),v?(0,r.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading posts..."})]}):w?(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm text-red-800",children:w})})]})}):0===u.length?(0,r.jsxs)("div",{className:"text-center py-8 sm:py-12",children:[(0,r.jsx)("svg",{className:"mx-auto h-10 w-10 sm:h-12 sm:w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No posts found"}),(0,r.jsx)("p",{className:"mt-1 text-xs sm:text-sm text-gray-500",children:"There are no posts available at the moment."})]}):(0,r.jsx)("div",{className:"viewer-container",children:(0,r.jsxs)("div",{className:"posts-list",children:[(0,r.jsxs)("div",{className:"mb-6 sm:mb-8",children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Latest Posts"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"Discover our latest articles and insights"})]}),(0,r.jsx)("div",{className:"grid gap-4 sm:gap-6 lg:gap-8",children:u.map(e=>(0,r.jsxs)("article",{className:"post-card bg-white border border-gray-200 rounded-lg p-4 sm:p-6 hover:shadow-md transition-shadow",itemScope:!0,itemType:"https://schema.org/BlogPosting",children:[(0,r.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,r.jsx)("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 mb-2 leading-tight",itemProp:"headline",children:(0,r.jsx)("button",{onClick:()=>A(e),className:"hover:text-blue-600 transition-colors text-left w-full",children:e.title})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center text-xs sm:text-sm text-gray-500 space-y-1 sm:space-y-0 sm:space-x-4",children:[(0,r.jsxs)("span",{itemProp:"author",children:["By ",e.author||"Admin"]}),(0,r.jsxs)("time",{dateTime:e.created_at,itemProp:"datePublished",children:["Published ",S(e.created_at)]}),e.updated_at&&e.updated_at!==e.created_at&&(0,r.jsxs)("time",{dateTime:e.updated_at,itemProp:"dateModified",className:"hidden sm:inline",children:["\u2022 Updated ",S(e.updated_at)]})]})]}),(0,r.jsx)("div",{className:"post-preview mb-3 sm:mb-4",itemProp:"description",children:(0,r.jsx)("div",{className:"text-sm sm:text-base text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:_(e.content)}})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-2 sm:space-y-0",children:[(0,r.jsx)("button",{onClick:()=>A(e),className:"text-blue-600 hover:text-blue-800 font-medium text-sm sm:text-base text-left",children:c?"Read full article":"Read more"}),!c&&e.content.length>m&&(0,r.jsxs)("div",{className:"text-xs sm:text-sm text-gray-500",children:[Math.ceil(e.content.length/100)," min read"]})]})]},e.id))}),N>1&&(0,r.jsx)("div",{className:"mt-6 sm:mt-8 flex justify-center",children:(0,r.jsxs)("nav",{className:"flex items-center space-x-1 sm:space-x-2",role:"navigation","aria-label":"Pagination",children:[j>1&&(0,r.jsx)("a",{href:"?page=".concat(j-1),onClick:e=>{e.preventDefault(),C(j-1)},className:"px-2 sm:px-3 py-2 text-xs sm:text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50",rel:"prev",children:"Previous"}),(0,r.jsxs)("span",{className:"px-2 sm:px-3 py-2 text-xs sm:text-sm text-gray-700",children:["Page ",j," of ",N]}),j<N&&(0,r.jsx)("a",{href:"?page=".concat(j+1),onClick:e=>{e.preventDefault(),C(j+1)},className:"px-2 sm:px-3 py-2 text-xs sm:text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50",rel:"next",children:"Next"})]})})]})})}},525:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var a=s(318),l=s(330),n=s.n(l),o=s(813),i=s(977),r=s(893);const d=e=>{let{postId:t,postSlug:s,apiUrl:l="http://localhost:8080/api",showLoginPrompt:d=!0,maxContentLength:c=800,isAuthenticated:m=!1,onLoginRequested:p,onPostLoaded:h,onError:x}=e;const[u,g]=(0,a.useState)(null),[v,b]=(0,a.useState)(!1),[w,f]=(0,a.useState)(null),j=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),y=(0,a.useCallback)(async()=>{b(!0),f(null);try{let e="".concat(l,"/posts");if(t)e+="/".concat(t);else{if(!s)throw new Error("Either postId or postSlug must be provided");e+="/slug/".concat(s)}const a=await n().get(e);if(!a.data||!a.data.data)throw new Error("Post not found");{const e=a.data.data;g(e);const t={id:e.id,title:e.title,content:e.content,slug:e.slug,published:e.published,created_at:e.created_at,updated_at:e.updated_at,user_id:e.user_id||"",author:e.author};null===h||void 0===h||h(t)}}catch(o){var e,a;const t=(null===(e=o.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||o.message||"Failed to load post";f(t),null===x||void 0===x||x(t)}finally{b(!1)}},[t,s,l,h,x]);return(0,a.useEffect)(()=>{(t||s)&&y()},[y,t,s]),v?(0,r.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading post..."})]}):w?(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm text-red-800",children:w})})]})}):u?(0,r.jsx)("div",{className:"viewer-container",children:(0,r.jsxs)("article",{className:"prose prose-sm sm:prose-base lg:prose-lg max-w-none",itemScope:!0,itemType:"https://schema.org/BlogPosting",children:[(0,r.jsxs)("header",{className:"mb-6 sm:mb-8",children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-3 sm:mb-4 leading-tight",itemProp:"headline",children:u.title}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center text-xs sm:text-sm text-gray-500 space-y-1 sm:space-y-0 sm:space-x-4",children:[(0,r.jsxs)("span",{itemProp:"author",children:["By ",u.author||"Admin"]}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"\u2022"}),(0,r.jsx)("time",{dateTime:u.created_at,itemProp:"datePublished",children:j(u.created_at)}),u.updated_at&&u.updated_at!==u.created_at&&(0,r.jsxs)("time",{dateTime:u.updated_at,itemProp:"dateModified",className:"hidden sm:inline",children:["\u2022 Updated ",j(u.updated_at)]})]})]}),(0,r.jsx)("div",{className:"prose prose-lg max-w-none",itemProp:"articleBody",dangerouslySetInnerHTML:{__html:(()=>{if(!u)return"";let e=u.content;return!m&&e.length>c&&(e=e.substring(0,c)+"..."),i.A.sanitize(o.marked.parse(e))})()}}),d&&!m&&u&&u.content.length>c&&(0,r.jsxs)("div",{className:"mt-6 sm:mt-8 p-4 sm:p-6 bg-gray-50 rounded-lg border",children:[(0,r.jsx)("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"Want to read more?"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mb-4",children:"Sign in to access the full article and discover more great content."}),(0,r.jsx)("button",{onClick:p,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 w-full sm:w-auto",children:"Sign In"})]})]})}):(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsx)("p",{className:"text-gray-500",children:"Post not found"})})}},587:(e,t,s)=>{function a(e,t){if(null==e)return{};var s={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;s[a]=e[a]}return s}s.d(t,{A:()=>a})},772:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var a=s(45),l=s(318),n=s(525),o=s(224),i=s(893);const r=["type"],d=e=>{var t,s,d;const[c,m]=(0,l.useState)(null),[p,h]=(0,l.useState)(),[x,u]=(0,l.useState)(),[g,v]=(0,l.useState)("http://localhost:8080/api"),[b,w]=(0,l.useState)(!0),[f,j]=(0,l.useState)(800),[y,N]=(0,l.useState)(!1),[P,L]=(0,l.useState)(!0),[S,_]=(0,l.useState)(1),[k,C]=(0,l.useState)(10),A=e=>{var t;console.error("Error:",e),null===(t=window.parent)||void 0===t||t.postMessage({type:"error",error:e},"*")},U=e=>{if(e.data&&"object"===typeof e.data){const t=e.data,{type:s}=t,l=(0,a.A)(t,r);switch(s){case"set-config":Object.assign({setApiUrl:v,setShowLoginPrompt:w,setMaxContentLength:j,setIsAuthenticated:N,setShowPublishedOnly:L,setPage:_,setLimit:C},l);break;case"set-post-id":h(l.postId),m("single");break;case"set-post-slug":u(l.postSlug),m("single");break;case"set-view-mode":m(l.mode)}}};(0,l.useEffect)(()=>(console.log("Viewer App: Mounted, parsing URL params..."),(()=>{const e=new URLSearchParams(window.location.search);console.log("Viewer: Raw URL params:",window.location.search),console.log("Viewer: All URL params:",Object.fromEntries(e.entries())),m(e.get("mode")||null),h(e.get("postId")||void 0),u(e.get("postSlug")||void 0),v(e.get("apiUrl")||"http://localhost:8080/api"),w("false"!==e.get("showLoginPrompt")),j(parseInt(e.get("maxContentLength")||"800")),N("true"===e.get("isAuthenticated")),L("false"!==e.get("showPublishedOnly")),_(parseInt(e.get("page")||"1")),C(parseInt(e.get("limit")||"10"))})(),window.addEventListener("message",U),console.log("Viewer App: In iframe?",window!==window.parent),console.log("Viewer App: Current URL:",window.location.href),()=>{window.removeEventListener("message",U)}),[]);const M={viewMode:e.mode||c,postId:e.postId||p,postSlug:e.postSlug||x,apiUrl:e.apiUrl||g,showLoginPrompt:null!==(t=e.showLoginPrompt)&&void 0!==t?t:b,maxContentLength:e.maxContentLength||f,isAuthenticated:null!==(s=e.isAuthenticated)&&void 0!==s?s:y,showPublishedOnly:null!==(d=e.showPublishedOnly)&&void 0!==d?d:P,page:e.page||S,limit:e.limit||k};return(0,i.jsxs)("div",{id:"app",children:["single"===M.viewMode&&(0,i.jsx)(n.default,{postId:M.postId,postSlug:M.postSlug,apiUrl:M.apiUrl,showLoginPrompt:M.showLoginPrompt,maxContentLength:M.maxContentLength,isAuthenticated:M.isAuthenticated,onLoginRequested:()=>{var e;console.log("Login requested"),null===(e=window.parent)||void 0===e||e.postMessage({type:"login-requested"},"*")},onPostLoaded:e=>{var t;console.log("Post loaded:",e),null===(t=window.parent)||void 0===t||t.postMessage({type:"post-loaded",post:e},"*")},onError:A}),"list"===M.viewMode&&(0,i.jsx)(o.default,{apiUrl:M.apiUrl,showPublishedOnly:M.showPublishedOnly,page:M.page,limit:M.limit,isAuthenticated:M.isAuthenticated,maxContentLength:M.maxContentLength,onPostClicked:e=>{var t;console.log("Post clicked:",e),null===(t=window.parent)||void 0===t||t.postMessage({type:"post-clicked",post:e},"*")},onPostsLoaded:e=>{var t;console.log("Posts loaded:",e),null===(t=window.parent)||void 0===t||t.postMessage({type:"posts-loaded",posts:e},"*")},onError:A}),!M.viewMode&&(0,i.jsx)("div",{className:"viewer-container",children:(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"AGoat Publisher Viewer"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:"This is a React microfrontend component for displaying blog posts."}),(0,i.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Usage Examples:"}),(0,i.jsxs)("div",{className:"text-left space-y-2 text-sm text-gray-700",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Single Post:"})," ?mode=single&postId=123"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Single Post by Slug:"})," ?mode=single&postSlug=my-post-title"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Posts List:"})," ?mode=list&page=1&limit=10"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Custom API:"})," &apiUrl=https://api.example.com"]})]})]})]})})]})}}}]);
//# sourceMappingURL=391.38220bc9.chunk.js.map