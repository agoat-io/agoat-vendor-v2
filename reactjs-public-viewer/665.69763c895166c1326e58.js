"use strict";(self.webpackChunkreactjs_public_viewer=self.webpackChunkreactjs_public_viewer||[]).push([[578,655,665],{45:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(587);function l(e,t){if(null==e)return{};var a,l,n=(0,s.A)(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(l=0;l<o.length;l++)a=o[l],-1===t.indexOf(a)&&{}.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}},578:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var s=a(850),l=a.n(s),n=a(215),o=a.n(n),r=a(824);const i=e=>{let{apiUrl:t="http://localhost:8080/api",showPublishedOnly:a=!0,page:n=1,limit:i=10,isAuthenticated:m=!1,maxContentLength:d=300,onPostClicked:c,onPostsLoaded:p,onError:u}=e;const[g,h]=(0,s.useState)([]),[x,v]=(0,s.useState)(!1),[b,w]=(0,s.useState)(null),[f,E]=(0,s.useState)(n),[y,N]=(0,s.useState)(1),[,P]=(0,s.useState)(0),L=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),S=e=>{let t=e;return!m&&t.length>d&&(t=t.substring(0,d)+"..."),r.marked.parse(t)},_=(0,s.useCallback)(async()=>{console.log("PostsList: Fetching posts with params:",{apiUrl:t,page:f,limit:i,showPublishedOnly:a||!m}),v(!0),w(null);try{const l=new URLSearchParams({page:f.toString(),limit:i.toString()});!a&&m||l.append("published","true");const n="".concat(t,"/posts?").concat(l);console.log("PostsList: Making request to:",n);const r=await o().get(n);var e,s;r.data&&r.data.data?(h(r.data.data),P((null===(e=r.data.meta)||void 0===e?void 0:e.total)||r.data.data.length),N((null===(s=r.data.meta)||void 0===s?void 0:s.total_pages)||Math.ceil(r.data.data.length/i)),console.log("PostsList: Loaded posts:",r.data.data.length),null==p||p(r.data.data)):h([])}catch(e){var l;const t=(null===(l=e.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.message)||e.message||"Failed to load posts";w(t),null==u||u(t)}finally{v(!1)}},[t,f,i,a,m,p,u]),k=e=>{e>=1&&e<=y&&E(e)},C=e=>{const t="".concat(e.slug,"/").concat(e.id),a=new URL(window.location.href);a.searchParams.set("post-path",t),window.history.pushState({},"",a.toString()),null==c||c(e)};return(0,s.useEffect)(()=>{_()},[_]),(0,s.useEffect)(()=>{E(n)},[n]),x?l().createElement("div",{className:"flex justify-center items-center py-12"},l().createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l().createElement("span",{className:"ml-3 text-gray-600"},"Loading posts...")):b?l().createElement("div",{className:"bg-red-50 border border-red-200 rounded-md p-4"},l().createElement("div",{className:"flex"},l().createElement("div",{className:"flex-shrink-0"},l().createElement("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},l().createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))),l().createElement("div",{className:"ml-3"},l().createElement("p",{className:"text-sm text-red-800"},b)))):0===g.length?l().createElement("div",{className:"text-center py-8 sm:py-12"},l().createElement("svg",{className:"mx-auto h-10 w-10 sm:h-12 sm:w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},l().createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})),l().createElement("h3",{className:"mt-2 text-sm font-medium text-gray-900"},"No posts found"),l().createElement("p",{className:"mt-1 text-xs sm:text-sm text-gray-500"},"There are no posts available at the moment.")):l().createElement("div",{className:"viewer-container"},l().createElement("div",{className:"posts-list"},l().createElement("div",{className:"mb-6 sm:mb-8"},l().createElement("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2"},"Latest Posts"),l().createElement("p",{className:"text-sm sm:text-base text-gray-600"},"Discover our latest articles and insights")),l().createElement("div",{className:"grid gap-4 sm:gap-6 lg:gap-8"},g.map(e=>l().createElement("article",{key:e.id,className:"post-card bg-white border border-gray-200 rounded-lg p-4 sm:p-6 hover:shadow-md transition-shadow",itemScope:!0,itemType:"https://schema.org/BlogPosting"},l().createElement("div",{className:"mb-3 sm:mb-4"},l().createElement("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 mb-2 leading-tight",itemProp:"headline"},l().createElement("button",{onClick:()=>C(e),className:"hover:text-blue-600 transition-colors text-left w-full"},e.title)),l().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center text-xs sm:text-sm text-gray-500 space-y-1 sm:space-y-0 sm:space-x-4"},l().createElement("span",{itemProp:"author"},"By ",e.author||"Admin"),l().createElement("time",{dateTime:e.created_at,itemProp:"datePublished"},"Published ",L(e.created_at)),e.updated_at&&e.updated_at!==e.created_at&&l().createElement("time",{dateTime:e.updated_at,itemProp:"dateModified",className:"hidden sm:inline"},"• Updated ",L(e.updated_at)))),l().createElement("div",{className:"post-preview mb-3 sm:mb-4",itemProp:"description"},l().createElement("div",{className:"text-sm sm:text-base text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:S(e.content)}})),l().createElement("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-2 sm:space-y-0"},l().createElement("button",{onClick:()=>C(e),className:"text-blue-600 hover:text-blue-800 font-medium text-sm sm:text-base text-left"},m?"Read full article":"Read more"),!m&&e.content.length>d&&l().createElement("div",{className:"text-xs sm:text-sm text-gray-500"},Math.ceil(e.content.length/100)," min read"))))),y>1&&l().createElement("div",{className:"mt-6 sm:mt-8 flex justify-center"},l().createElement("nav",{className:"flex items-center space-x-1 sm:space-x-2",role:"navigation","aria-label":"Pagination"},f>1&&l().createElement("a",{href:"?page=".concat(f-1),onClick:e=>{e.preventDefault(),k(f-1)},className:"px-2 sm:px-3 py-2 text-xs sm:text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50",rel:"prev"},"Previous"),l().createElement("span",{className:"px-2 sm:px-3 py-2 text-xs sm:text-sm text-gray-700"},"Page ",f," of ",y),f<y&&l().createElement("a",{href:"?page=".concat(f+1),onClick:e=>{e.preventDefault(),k(f+1)},className:"px-2 sm:px-3 py-2 text-xs sm:text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50",rel:"next"},"Next")))))}},587:(e,t,a)=>{function s(e,t){if(null==e)return{};var a={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(-1!==t.indexOf(s))continue;a[s]=e[s]}return a}a.d(t,{A:()=>s})},655:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var s=a(850),l=a.n(s),n=a(215),o=a.n(n),r=a(824);const i=e=>{let{postId:t,postSlug:a,apiUrl:n="http://localhost:8080/api",showLoginPrompt:i=!0,maxContentLength:m=800,isAuthenticated:d=!1,onLoginRequested:c,onPostLoaded:p,onError:u}=e;const[g,h]=(0,s.useState)(null),[x,v]=(0,s.useState)(!1),[b,w]=(0,s.useState)(null),f=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),E=(0,s.useCallback)(async()=>{v(!0),w(null);try{let e="".concat(n,"/posts");if(t)e+="/".concat(t);else{if(!a)throw new Error("Either postId or postSlug must be provided");e+="/slug/".concat(a)}const s=await o().get(e);if(!s.data||!s.data.data)throw new Error("Post not found");{const e=s.data.data;h(e);const t={id:e.id,title:e.title,content:e.content,slug:e.slug,published:e.published,created_at:e.created_at,updated_at:e.updated_at,user_id:e.user_id||"",author:e.author};null==p||p(t)}}catch(t){var e;const a=(null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)||t.message||"Failed to load post";w(a),null==u||u(a)}finally{v(!1)}},[t,a,n,p,u]);return(0,s.useEffect)(()=>{(t||a)&&E()},[E]),x?l().createElement("div",{className:"flex justify-center items-center py-12"},l().createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l().createElement("span",{className:"ml-3 text-gray-600"},"Loading post...")):b?l().createElement("div",{className:"bg-red-50 border border-red-200 rounded-md p-4"},l().createElement("div",{className:"flex"},l().createElement("div",{className:"flex-shrink-0"},l().createElement("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},l().createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))),l().createElement("div",{className:"ml-3"},l().createElement("p",{className:"text-sm text-red-800"},b)))):g?l().createElement("div",{className:"viewer-container"},l().createElement("article",{className:"prose prose-sm sm:prose-base lg:prose-lg max-w-none",itemScope:!0,itemType:"https://schema.org/BlogPosting"},l().createElement("header",{className:"mb-6 sm:mb-8"},l().createElement("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-3 sm:mb-4 leading-tight",itemProp:"headline"},g.title),l().createElement("div",{className:"flex flex-col sm:flex-row sm:items-center text-xs sm:text-sm text-gray-500 space-y-1 sm:space-y-0 sm:space-x-4"},l().createElement("span",{itemProp:"author"},"By ",g.author||"Admin"),l().createElement("span",{className:"hidden sm:inline"},"•"),l().createElement("time",{dateTime:g.created_at,itemProp:"datePublished"},f(g.created_at)),g.updated_at&&g.updated_at!==g.created_at&&l().createElement("time",{dateTime:g.updated_at,itemProp:"dateModified",className:"hidden sm:inline"},"• Updated ",f(g.updated_at)))),l().createElement("div",{className:"prose prose-lg max-w-none",itemProp:"articleBody",dangerouslySetInnerHTML:{__html:(()=>{if(!g)return"";let e=g.content;return!d&&e.length>m&&(e=e.substring(0,m)+"..."),r.marked.parse(e)})()}}),i&&!d&&g&&g.content.length>m&&l().createElement("div",{className:"mt-6 sm:mt-8 p-4 sm:p-6 bg-gray-50 rounded-lg border"},l().createElement("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2"},"Want to read more?"),l().createElement("p",{className:"text-sm sm:text-base text-gray-600 mb-4"},"Sign in to access the full article and discover more great content."),l().createElement("button",{onClick:c,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 w-full sm:w-auto"},"Sign In")))):l().createElement("div",{className:"text-center py-12"},l().createElement("p",{className:"text-gray-500"},"Post not found"))}},665:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var s=a(45),l=a(850),n=a.n(l),o=a(655),r=a(578);const i=["type"],m=e=>{var t,a,m;const[d,c]=(0,l.useState)(null),[p,u]=(0,l.useState)(),[g,h]=(0,l.useState)(),[x,v]=(0,l.useState)("http://localhost:8080/api"),[b,w]=(0,l.useState)(!0),[f,E]=(0,l.useState)(800),[y,N]=(0,l.useState)(!1),[P,L]=(0,l.useState)(!0),[S,_]=(0,l.useState)(1),[k,C]=(0,l.useState)(10),U=e=>{var t;console.error("Error:",e),null===(t=window.parent)||void 0===t||t.postMessage({type:"error",error:e},"*")},A=e=>{if(e.data&&"object"==typeof e.data){const t=e.data,{type:a}=t,l=(0,s.A)(t,i);switch(a){case"set-config":Object.assign({setApiUrl:v,setShowLoginPrompt:w,setMaxContentLength:E,setIsAuthenticated:N,setShowPublishedOnly:L,setPage:_,setLimit:C},l);break;case"set-post-id":u(l.postId),c("single");break;case"set-post-slug":h(l.postSlug),c("single");break;case"set-view-mode":c(l.mode)}}};(0,l.useEffect)(()=>(console.log("Viewer App: Mounted, parsing URL params..."),(()=>{const e=new URLSearchParams(window.location.search);console.log("Viewer: Raw URL params:",window.location.search),console.log("Viewer: All URL params:",Object.fromEntries(e.entries())),c(e.get("mode")||null),u(e.get("postId")||void 0),h(e.get("postSlug")||void 0),v(e.get("apiUrl")||"http://localhost:8080/api"),w("false"!==e.get("showLoginPrompt")),E(parseInt(e.get("maxContentLength")||"800")),N("true"===e.get("isAuthenticated")),L("false"!==e.get("showPublishedOnly")),_(parseInt(e.get("page")||"1")),C(parseInt(e.get("limit")||"10"))})(),window.addEventListener("message",A),console.log("Viewer App: In iframe?",window!==window.parent),console.log("Viewer App: Current URL:",window.location.href),()=>{window.removeEventListener("message",A)}),[]);const M={viewMode:e.mode||d,postId:e.postId||p,postSlug:e.postSlug||g,apiUrl:e.apiUrl||x,showLoginPrompt:null!==(t=e.showLoginPrompt)&&void 0!==t?t:b,maxContentLength:e.maxContentLength||f,isAuthenticated:null!==(a=e.isAuthenticated)&&void 0!==a?a:y,showPublishedOnly:null!==(m=e.showPublishedOnly)&&void 0!==m?m:P,page:e.page||S,limit:e.limit||k};return n().createElement("div",{id:"app"},"single"===M.viewMode&&n().createElement(o.default,{postId:M.postId,postSlug:M.postSlug,apiUrl:M.apiUrl,showLoginPrompt:M.showLoginPrompt,maxContentLength:M.maxContentLength,isAuthenticated:M.isAuthenticated,onLoginRequested:()=>{var e;console.log("Login requested"),null===(e=window.parent)||void 0===e||e.postMessage({type:"login-requested"},"*")},onPostLoaded:e=>{var t;console.log("Post loaded:",e),null===(t=window.parent)||void 0===t||t.postMessage({type:"post-loaded",post:e},"*")},onError:U}),"list"===M.viewMode&&n().createElement(r.default,{apiUrl:M.apiUrl,showPublishedOnly:M.showPublishedOnly,page:M.page,limit:M.limit,isAuthenticated:M.isAuthenticated,maxContentLength:M.maxContentLength,onPostClicked:e=>{var t;console.log("Post clicked:",e),null===(t=window.parent)||void 0===t||t.postMessage({type:"post-clicked",post:e},"*")},onPostsLoaded:e=>{var t;console.log("Posts loaded:",e),null===(t=window.parent)||void 0===t||t.postMessage({type:"posts-loaded",posts:e},"*")},onError:U}),!M.viewMode&&n().createElement("div",{className:"viewer-container"},n().createElement("div",{className:"text-center py-12"},n().createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-4"},"AGoat Publisher Viewer"),n().createElement("p",{className:"text-gray-600 mb-6"},"This is a React microfrontend component for displaying blog posts."),n().createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},n().createElement("h2",{className:"text-lg font-semibold text-gray-800 mb-3"},"Usage Examples:"),n().createElement("div",{className:"text-left space-y-2 text-sm text-gray-700"},n().createElement("p",null,n().createElement("strong",null,"Single Post:")," ?mode=single&postId=123"),n().createElement("p",null,n().createElement("strong",null,"Single Post by Slug:")," ?mode=single&postSlug=my-post-title"),n().createElement("p",null,n().createElement("strong",null,"Posts List:")," ?mode=list&page=1&limit=10"),n().createElement("p",null,n().createElement("strong",null,"Custom API:")," &apiUrl=https://api.example.com"))))))}}}]);